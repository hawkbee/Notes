Content-Type: text/x-zim-wiki
Wiki-Format: zim 0.4
Creation-Date: 2012-09-11T09:53:23+08:00

====== 第八章 UDP套接字基础 ======
Created Tuesday 11 September 2012

UDP报文丢失
1. 服务器没有接收到客户端发送的报文。
2. 客户端没有接收到服务器端发送的报文。

这两种情况在客户端通过定时机制可以得到解决。但定时机制没有办法确认报文是在情况1还是情况2下丢失的。

验证收到的回应
任何知道客户端端口号的进程都可以向客户端发送消息，这样就可能与真正的服务器相混淆（intermixed with）。recvfrom接口可以返回服务器的IP地址和端口。但通过判断服务器的IP地址和端口的方案存在一些陷阱。
对于多端口主机来说（Berkeley-derived）。它可以从任何一个接口接收发送给任意一个IP地址的报文，不管与接口配置的IP地址是否匹配。这时就需要通过域名方式来判断确认了。另外服务器端也可以将服务绑定到指定的IP地址。

服务器没有运行
当服务器没有运行时，服务器返回ICMP消息port unreachable，但是这个消息并没有返回给客户端发送进程，因为ICMP错误是一个异步错误。这个错误是由sendto导致的，但是sendto却成功返回了（这个成功返回只表示发送socket有足够的发送缓存）。

connect
调用connect接口可以提高工作效率，如果需要传输较多数据量，则在传输前调用connect。

